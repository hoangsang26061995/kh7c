<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bảng Giá Vàng - Kim Hoàng Bảy Chanh</title>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Open Sans', sans-serif;
      background: url('./images/NEN.PNG') no-repeat center center fixed;
      background-size: cover;
      color: #000;
    }
    .container {
      max-width: 1200px;
      margin: auto;
      padding: 0 20px;
      text-align: center;
    }
    .logo {
      position: fixed;
      top: 10px;
      left: 10px;
      width: 150px;
      height: 150px;
      background-image: url('./images/kh7cxoaphong.png');
      background-size: cover;
      z-index: 1000;
      animation: blink 2s infinite;
    }
    @keyframes blink {
      0% {
        opacity: 1;
      }
      50% {
        opacity: 0.5;
      }
      100% {
        opacity: 1;
      }
    }
    .highlight-header {
      background-color: red;
      color: yellow;
      font-weight: bold;
      text-shadow: 1px 1px 2px black;
      border-radius: 10px;
      margin: 10px auto;
      padding: 5px 10px;
      user-select: none;
      display: inline-block;
      border: 2px solid yellow;
      transition: all 0.3s ease;
    }
    .highlight-header:hover {
      background-color: #ff3737;
      transform: scale(1.1);
    }
    .highlight-header.kimhoang {
      font-size: 2.5rem;
      display: block;
      width: fit-content;
    }
    .sub-header {
      font-weight: bold;
      font-size: 1.2rem;
      color: darkblue;
      text-align: center;
      margin-bottom: 10px;
      user-select: none;
    }
    .price-table {
      display: grid;
      grid-template-columns: 2fr 4fr 4fr;
      gap: 10px;
      border: 2px solid red;
      border-radius: 15px;
      padding: 10px;
      user-select: none;
      background-color: transparent;
    }
    .price-table .header-cell {
      background-color: red;
      color: yellow;
      font-weight: bold;
      font-size: 1.5rem;
      padding: 10px;
      border-radius: 10px;
      text-align: center;
      border: 2px solid yellow;
    }
    .price-table .cell {
      font-weight: bold;
      text-align: center;
      padding: 10px 5px;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: all 0.3s ease;
    }
    .price-table .cell:hover {
      background-color: #f1c40f;
      transform: scale(1.1);
    }
    .price-table .gold-type {
      background-color: red;
      color: yellow;
      font-weight: bold;
      border-radius: 10px;
      padding: 5px 10px;
      font-size: 1.5rem;
      border: 2px solid yellow;
    }
    .price-table .price-cell {
      font-size: 4rem;
      color: blue;
      margin: 0 10px;
      text-decoration: underline;
      text-decoration-color: blue;
      text-decoration-thickness: 2px;
    }
  </style>
</head>
<body>
  <div class="logo"></div>
  font-size: 100px;
  height: 100px;
  background-image: url('./images/kh7cxoaphong.png');
  background-size: cover;
  z-index: 1000;
  animation: blink 2s infinite;
</body>
</html>

<script>
  function updateDateTime() {
    const now = new Date();
    const formatted = now.toLocaleString('vi-VN');
    document.getElementById('datetime').textContent = formatted;
  }

  updateDateTime();
  setInterval(updateDateTime, 1000);

  function updateData() {
    fetch('https://script.google.com/macros/s/AKfycbz7lGg7DEm6-H7MzV4enR0DIbOrmXmFNmT-HlUXsf349221-zHorwxFmN7PjylVSXgNXg/exec')
      .then(response => response.json())
      .then(data => {
        const priceTable = document.querySelector('.price-table');
        while (priceTable.children.length > 3) {
          priceTable.removeChild(priceTable.lastChild);
        }
        data.forEach(item => {
          const loaiCell = document.createElement('div');
          loaiCell.className = 'cell';
          loaiCell.innerHTML = `<span class="gold-type">${item.loai}</span>`;

          const muaCell = document.createElement('div');
          muaCell.className = 'cell price-cell buy';
          muaCell.textContent = item.mua;

          const banCell = document.createElement('div');
          banCell.className = 'cell price-cell sold';
          banCell.textContent = item.ban;

          priceTable.appendChild(loaiCell);
          priceTable.appendChild(muaCell);
          priceTable.appendChild(banCell);
        });
      })
      .catch(error => {
        console.error("Lỗi khi lấy dữ liệu từ Google Sheets:", error);
      });
  }

  updateData();
  setInterval(updateData, 1000);
</script>
